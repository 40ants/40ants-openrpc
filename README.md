<a id="x-2840ANTS-OPENRPC-DOCS-2FINDEX-3A-40README-2040ANTS-DOC-2FLOCATIVES-3ASECTION-29"></a>

# 40ants-openrpc - A set of helpers to start JSON-RPC server based on https://40ants.com/openrpc/ library.

<a id="40-ants-openrpc-asdf-system-details"></a>

## 40ANTS-OPENRPC ASDF System Details

* Version: 0.1.0

* Description: A set of helpers to start `JSON-RPC` server based on https://40ants.com/openrpc/ library.

* Licence: Unlicense

* Author: Alexander Artemenko <svetlyak.40wt@gmail.com>

* Homepage: [https://40ants.com/40ants-openrpc/][e778]

* Bug tracker: [https://github.com/40ants/40ants-openrpc/issues][a84b]

* Source control: [GIT][8702]

* Depends on: [40ants-logging][422a], [40ants-slynk][2e1d], [cl+ssl][fca9], [clack][482d], [clack-cors][087e], [local-time][46a1], [openrpc-server][c8e7]

[![](https://github-actions.40ants.com/40ants/40ants-openrpc/matrix.svg?only=ci.run-tests)][bc95]

![](http://quickdocs.org/badge/40ants-openrpc.svg)

<a id="x-2840ANTS-OPENRPC-DOCS-2FINDEX-3A-3A-40INSTALLATION-2040ANTS-DOC-2FLOCATIVES-3ASECTION-29"></a>

## Installation

You can install this library from Quicklisp, but you want to receive updates quickly, then install it from Ultralisp.org:

```
(ql-dist:install-dist "http://dist.ultralisp.org/"
                      :prompt nil)
(ql:quickload :40ants-openrpc)
```
<a id="x-2840ANTS-OPENRPC-DOCS-2FINDEX-3A-3A-40USAGE-2040ANTS-DOC-2FLOCATIVES-3ASECTION-29"></a>

## Usage

This is a set of opionated helpers for starting Common Lisp `OpenRPC` servers which uses:

* https://40ants.com/openrpc/

* https://40ants.com/logging/

* https://40ants.com/slynk/

Also, it can manage a multiple Open`RPC` servers in the one Lisp image.

The easiest way to start a server is to define one or more api methods using `OpenRPC` library
and then call [`start`][999c]. This will bring `API` on http://localhost:8080/ and it's spec will be available
as http://localhost:8080/openrpc.json

This system uses following environment variables to configure the server:

* `APP_PORT` and `APP_INTERFACE` are used in [`start-in-production`][e921] function to control on which port and interface
  `API` should be started on.

* `DEBUG` also used in [`start-in-production`][e921] function to control how verbose logging should be. If it is given
  then logging will be with `DEBUG` level.

* `CORS_ALLOWED_ORIGIN` and `CORS_ALLOWED_HEADERS` are control how `API` will respond with `CORS` related headers.
  Learn more about used middleware in [`clack-cors`][5314] system documentation.

<a id="x-2840ANTS-OPENRPC-DOCS-2FINDEX-3A-3A-40API-2040ANTS-DOC-2FLOCATIVES-3ASECTION-29"></a>

### API

<a id="x-2840ANTS-OPENRPC-2FSERVER-3ASTART-20FUNCTION-29"></a>

#### [function](f57b) `40ants-openrpc/server:start` &key (port \*default-port\*) (api openrpc-server/api::default-api) (interface \*default-interface\*) (debug nil)

Starts Open `RPC` `API` server on given `PORT` and `INTERFACE`.
Also it configures logging and Slynk.

Slynk is started only if `SLYNK`_`PORT` env variable is set to some value.
You will find more details in the [`40ants-slynk`][04ac] system documentation.

<a id="x-2840ANTS-OPENRPC-2FSERVER-3ASTOP-20FUNCTION-29"></a>

#### [function](dfdb) `40ants-openrpc/server:stop` &key (port \*default-port\*) (interface \*default-interface\*)

Stops `API` server running on given `PORT` and `INTERFACE`.

<a id="x-2840ANTS-OPENRPC-2FSERVER-3ASTART-IN-PRODUCTION-20FUNCTION-29"></a>

#### [function](dbf8) `40ants-openrpc/server:start-in-production` &key (api openrpc-server/api::default-api)

Entry point for `API` webserver, started in the Docker or Kubernetes.
It works like a [`start`][999c] but blocks forever.


[e778]: https://40ants.com/40ants-openrpc/
[999c]: https://40ants.com/40ants-openrpc/#x-2840ANTS-OPENRPC-2FSERVER-3ASTART-20FUNCTION-29
[e921]: https://40ants.com/40ants-openrpc/#x-2840ANTS-OPENRPC-2FSERVER-3ASTART-IN-PRODUCTION-20FUNCTION-29
[5314]: https://40ants.com/clack-cors/#x-28-23A-28-2810-29-20BASE-CHAR-20-2E-20-22clack-cors-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29
[04ac]: https://40ants.com/slynk/#x-28-23A-28-2812-29-20BASE-CHAR-20-2E-20-2240ants-slynk-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29
[8702]: https://github.com/40ants/40ants-openrpc
[bc95]: https://github.com/40ants/40ants-openrpc/actions
[f57b]: https://github.com/40ants/40ants-openrpc/blob/bd3007984333e15c4b8f4b72794ccc0c062e9de6/src/server.lisp#L40
[dfdb]: https://github.com/40ants/40ants-openrpc/blob/bd3007984333e15c4b8f4b72794ccc0c062e9de6/src/server.lisp#L82
[dbf8]: https://github.com/40ants/40ants-openrpc/blob/bd3007984333e15c4b8f4b72794ccc0c062e9de6/src/server.lisp#L92
[a84b]: https://github.com/40ants/40ants-openrpc/issues
[422a]: https://quickdocs.org/40ants-logging
[2e1d]: https://quickdocs.org/40ants-slynk
[fca9]: https://quickdocs.org/cl+ssl
[482d]: https://quickdocs.org/clack
[087e]: https://quickdocs.org/clack-cors
[46a1]: https://quickdocs.org/local-time
[c8e7]: https://quickdocs.org/openrpc-server

* * *
###### [generated by [40ANTS-DOC](https://40ants.com/doc/)]
